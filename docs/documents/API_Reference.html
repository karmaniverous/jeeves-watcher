<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>API Reference | @karmaniverous/jeeves-watcher</title><meta name="description" content="Documentation for @karmaniverous/jeeves-watcher"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">@karmaniverous/jeeves-watcher</a><div id="tsd-toolbar-links"><a href="https://github.com/karmaniverous/jeeves-watcher">GitHub</a></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">API Reference</a></li></ul></div><div class="tsd-panel tsd-typography"><h1 id="api-reference" class="tsd-anchor-link">API Reference<a href="#api-reference" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1>
<p>The watcher exposes a lightweight HTTP API for search, metadata enrichment, and operational control.</p>
<p><strong>Default address:</strong> <code>http://127.0.0.1:3100</code> (configurable via <code>api.host</code> and <code>api.port</code>)</p>
<hr>
<h2 id="get-status" class="tsd-anchor-link">GET /status<a href="#get-status" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Health check and service stats.</p>
<h3 id="request" class="tsd-anchor-link">Request<a href="#request" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/status</span>
</code><button type="button">Copy</button></pre>

<h3 id="response" class="tsd-anchor-link">Response<a href="#response" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;status&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;ok&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;uptime&quot;</span><span class="hl-1">: </span><span class="hl-5">86400</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>status</code></td>
<td><code>string</code></td>
<td>Always <code>&quot;ok&quot;</code> if the server is responding.</td>
</tr>
<tr>
<td><code>uptime</code></td>
<td><code>number</code></td>
<td>Process uptime in seconds.</td>
</tr>
</tbody>
</table>
<p><strong>Status codes:</strong></p>
<ul>
<li><code>200 OK</code> — Service is healthy</li>
</ul>
<hr>
<h2 id="post-metadata" class="tsd-anchor-link">POST /metadata<a href="#post-metadata" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Enrich a document's metadata without re-embedding.</p>
<h3 id="request-1" class="tsd-anchor-link">Request<a href="#request-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/metadata</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{</span><br/><span class="hl-2">    &quot;path&quot;: &quot;D:/projects/readme.md&quot;,</span><br/><span class="hl-2">    &quot;metadata&quot;: {</span><br/><span class="hl-2">      &quot;title&quot;: &quot;Project Overview&quot;,</span><br/><span class="hl-2">      &quot;labels&quot;: [&quot;documentation&quot;, &quot;important&quot;],</span><br/><span class="hl-2">      &quot;priority&quot;: &quot;high&quot;</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  }&#39;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Body schema:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;                    </span><span class="hl-9">// File path (must be indexed)</span><br/><span class="hl-1">  </span><span class="hl-7">metadata</span><span class="hl-1">: </span><span class="hl-8">Record</span><span class="hl-1">&lt;</span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-8">unknown</span><span class="hl-1">&gt;;  </span><span class="hl-9">// Metadata to merge</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-1" class="tsd-anchor-link">Response<a href="#response-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Success (200 OK):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;ok&quot;</span><span class="hl-1">: </span><span class="hl-3">true</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Error (500 Internal Server Error):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Internal server error&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="behavior" class="tsd-anchor-link">Behavior<a href="#behavior" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<ol>
<li>Reads existing enrichment metadata from the metadata store</li>
<li>Merges provided metadata (new values override existing)</li>
<li>Writes merged metadata to <code>.meta.json</code> sidecar file</li>
<li>Updates all chunk payloads in Qdrant (no re-embedding)</li>
</ol>
<p><strong>If the file isn't indexed yet:</strong></p>
<ul>
<li>The metadata is written to the metadata store</li>
<li>The file will be processed on the next filesystem event or manual reindex</li>
</ul>
<hr>
<h2 id="post-search" class="tsd-anchor-link">POST /search<a href="#post-search" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Semantic search across indexed documents.</p>
<h3 id="request-2" class="tsd-anchor-link">Request<a href="#request-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/search</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{</span><br/><span class="hl-2">    &quot;query&quot;: &quot;machine learning algorithms&quot;,</span><br/><span class="hl-2">    &quot;limit&quot;: 10</span><br/><span class="hl-2">  }&#39;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Body schema:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">query</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;   </span><span class="hl-9">// Natural language search query</span><br/><span class="hl-1">  </span><span class="hl-8">limit</span><span class="hl-1">?: </span><span class="hl-8">number</span><span class="hl-1">;  </span><span class="hl-9">// Max results (default: 10)</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-2" class="tsd-anchor-link">Response<a href="#response-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Success (200 OK):</strong></p>
<pre><code class="json"><span class="hl-1">[</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;uuid-chunk-0&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;score&quot;</span><span class="hl-1">: </span><span class="hl-5">0.87</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;payload&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;file_path&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;d:/projects/ml/readme.md&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;chunk_index&quot;</span><span class="hl-1">: </span><span class="hl-5">0</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;total_chunks&quot;</span><span class="hl-1">: </span><span class="hl-5">3</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;content_hash&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;sha256:abc123...&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;chunk_text&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Machine learning is...&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;domain&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;projects&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;ML Overview&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;id&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;uuid-chunk-1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;score&quot;</span><span class="hl-1">: </span><span class="hl-5">0.82</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;payload&quot;</span><span class="hl-1">: { </span><span class="hl-9">/* ... */</span><span class="hl-1"> }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">]</span>
</code><button type="button">Copy</button></pre>

<p><strong>Error (500 Internal Server Error):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Internal server error&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-schema" class="tsd-anchor-link">Response Schema<a href="#response-schema" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p>Each result is a Qdrant point:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><code>string</code></td>
<td>Qdrant point ID (deterministic UUID from file path + chunk index).</td>
</tr>
<tr>
<td><code>score</code></td>
<td><code>number</code></td>
<td>Cosine similarity score (0–1, higher is better).</td>
</tr>
<tr>
<td><code>payload</code></td>
<td><code>object</code></td>
<td>Document metadata and chunk info.</td>
</tr>
</tbody>
</table>
<p><strong>Payload fields:</strong></p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td><code>string</code></td>
<td>Normalized file path (forward slashes).</td>
</tr>
<tr>
<td><code>chunk_index</code></td>
<td><code>number</code></td>
<td>Chunk index (0-based).</td>
</tr>
<tr>
<td><code>total_chunks</code></td>
<td><code>number</code></td>
<td>Total chunks for this file.</td>
</tr>
<tr>
<td><code>content_hash</code></td>
<td><code>string</code></td>
<td>SHA-256 hash of extracted text.</td>
</tr>
<tr>
<td><code>chunk_text</code></td>
<td><code>string</code></td>
<td>Text content of this chunk.</td>
</tr>
<tr>
<td><em>Custom fields</em></td>
<td><code>any</code></td>
<td>Metadata from inference rules and <code>POST /metadata</code>.</td>
</tr>
</tbody>
</table>
<h3 id="behavior-1" class="tsd-anchor-link">Behavior<a href="#behavior-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<ol>
<li>Embeds the query text using the configured embedding provider</li>
<li>Searches Qdrant using cosine similarity</li>
<li>Returns top <code>limit</code> results (includes all chunks; caller groups by <code>file_path</code> if needed)</li>
</ol>
<hr>
<h2 id="post-reindex" class="tsd-anchor-link">POST /reindex<a href="#post-reindex" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Trigger a full reindex of all watched files.</p>
<h3 id="request-3" class="tsd-anchor-link">Request<a href="#request-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/reindex</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-3" class="tsd-anchor-link">Response<a href="#response-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Success (200 OK):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;ok&quot;</span><span class="hl-1">: </span><span class="hl-3">true</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;filesIndexed&quot;</span><span class="hl-1">: </span><span class="hl-5">1234</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Error (500 Internal Server Error):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Internal server error&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="behavior-2" class="tsd-anchor-link">Behavior<a href="#behavior-2" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<ol>
<li>Scans all <code>watch.paths</code> globs</li>
<li>For each file:
<ul>
<li>Extracts text</li>
<li>Computes content hash</li>
<li>If hash differs from Qdrant (or file not indexed): re-embed and upsert</li>
<li>If hash matches: skip (no re-embedding)</li>
</ul>
</li>
<li>Processes sequentially to avoid overwhelming the embedding API</li>
</ol>
<p><strong>Use cases:</strong></p>
<ul>
<li>Recovering from Qdrant data loss</li>
<li>Indexing a large batch of new files</li>
<li>After bulk file operations (e.g., git pull)</li>
</ul>
<p><strong>Note:</strong> This is a blocking operation — the API returns after all files are processed. For very large corpora, expect long response times.</p>
<hr>
<h2 id="post-rebuild-metadata" class="tsd-anchor-link">POST /rebuild-metadata<a href="#post-rebuild-metadata" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Rebuild the metadata store from Qdrant payloads.</p>
<h3 id="request-4" class="tsd-anchor-link">Request<a href="#request-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/rebuild-metadata</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-4" class="tsd-anchor-link">Response<a href="#response-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Success (200 OK):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;ok&quot;</span><span class="hl-1">: </span><span class="hl-3">true</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Error (500 Internal Server Error):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Internal server error&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="behavior-3" class="tsd-anchor-link">Behavior<a href="#behavior-3" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<ol>
<li>Scrolls all Qdrant points in the collection</li>
<li>For each point:
<ul>
<li>Extracts <code>file_path</code> and enrichment metadata from payload</li>
<li>Writes a <code>.meta.json</code> sidecar file to the metadata store</li>
</ul>
</li>
<li>Skips internal fields (<code>chunk_index</code>, <code>total_chunks</code>, <code>content_hash</code>, <code>chunk_text</code>)</li>
</ol>
<p><strong>Use cases:</strong></p>
<ul>
<li>Metadata store corruption or accidental deletion</li>
<li>Migrating to a new machine (copy Qdrant snapshot, rebuild metadata store)</li>
<li>First-time setup from an existing Qdrant collection</li>
</ul>
<p><strong>Cost:</strong> No embedding API calls — pure data extraction.</p>
<hr>
<h2 id="post-config-reindex" class="tsd-anchor-link">POST /config-reindex<a href="#post-config-reindex" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>Reindex after configuration changes (rules update or full reindex).</p>
<h3 id="request-5" class="tsd-anchor-link">Request<a href="#request-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Scope: <code>rules</code> (default) — metadata-only reindex:</strong></p>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/config-reindex</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{&quot;scope&quot;: &quot;rules&quot;}&#39;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Scope: <code>full</code> — re-extract, re-embed, re-upsert:</strong></p>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/config-reindex</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{&quot;scope&quot;: &quot;full&quot;}&#39;</span>
</code><button type="button">Copy</button></pre>

<p><strong>Body schema:</strong></p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-8">scope</span><span class="hl-1">?: </span><span class="hl-2">&quot;rules&quot;</span><span class="hl-1"> | </span><span class="hl-2">&quot;full&quot;</span><span class="hl-1">;  </span><span class="hl-9">// Default: &quot;rules&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="response-5" class="tsd-anchor-link">Response<a href="#response-5" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<p><strong>Success (200 OK):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;status&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;started&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;scope&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;rules&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The reindex runs <strong>asynchronously</strong> — the API returns immediately.</p>
<p><strong>Error (500 Internal Server Error):</strong></p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Internal server error&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="behavior-4" class="tsd-anchor-link">Behavior<a href="#behavior-4" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<h4 id="scope" class="tsd-anchor-link">Scope: <code>rules</code><a href="#scope" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4>
<ol>
<li>Re-reads file attributes (path, stats, frontmatter, JSON)</li>
<li>Re-applies current inference rules</li>
<li>Merges with enrichment metadata from the metadata store</li>
<li>Updates Qdrant payloads (no re-embedding)</li>
</ol>
<p><strong>Use case:</strong> You edited inference rules and want to update metadata without re-embedding.</p>
<h4 id="scope-1" class="tsd-anchor-link">Scope: <code>full</code><a href="#scope-1" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4>
<ol>
<li>Re-extracts text from all files</li>
<li>Re-embeds (new embedding API calls)</li>
<li>Re-upserts to Qdrant</li>
</ol>
<p><strong>Use case:</strong> You changed embedding providers (e.g., Gemini 3072-dim → 768-dim) or chunk size.</p>
<hr>
<h2 id="error-handling" class="tsd-anchor-link">Error Handling<a href="#error-handling" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p>All endpoints return JSON errors with this schema:</p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Human-readable error message&quot;</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p><strong>Status codes:</strong></p>
<ul>
<li><code>200 OK</code> — Success</li>
<li><code>500 Internal Server Error</code> — Server-side failure (check logs for details)</li>
</ul>
<hr>
<h2 id="authentication" class="tsd-anchor-link">Authentication<a href="#authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p><strong>Current:</strong> None. The API is intended for localhost-only access (default <code>host: &quot;127.0.0.1&quot;</code>).</p>
<p><strong>For production:</strong> Use a reverse proxy (nginx, Caddy) with authentication, or bind to <code>0.0.0.0</code> only within a trusted network.</p>
<hr>
<h2 id="rate-limiting" class="tsd-anchor-link">Rate Limiting<a href="#rate-limiting" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p><strong>No built-in rate limiting.</strong> The embedding provider's rate limit (<code>embedding.rateLimitPerMinute</code>) applies, but the API itself is unbounded.</p>
<p>For high-traffic deployments, add rate limiting at the reverse proxy layer.</p>
<hr>
<h2 id="cors" class="tsd-anchor-link">CORS<a href="#cors" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<p><strong>Not enabled by default.</strong> To enable for browser access, modify the Fastify server initialization (code change required).</p>
<hr>
<h2 id="examples" class="tsd-anchor-link">Examples<a href="#examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<h3 id="search-and-display-results" class="tsd-anchor-link">Search and Display Results<a href="#search-and-display-results" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/search</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{&quot;query&quot;: &quot;billing integration&quot;, &quot;limit&quot;: 5}&#39;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">  | </span><span class="hl-0">jq</span><span class="hl-1"> </span><span class="hl-2">&#39;.[] | {score, path: .payload.file_path, title: .payload.title}&#39;</span>
</code><button type="button">Copy</button></pre>

<p>Output:</p>
<pre><code class="json"><span class="hl-1">{ </span><span class="hl-4">&quot;score&quot;</span><span class="hl-1">: </span><span class="hl-5">0.91</span><span class="hl-1">, </span><span class="hl-4">&quot;path&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;d:/projects/billing/spec.md&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Billing API Spec&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">{ </span><span class="hl-4">&quot;score&quot;</span><span class="hl-1">: </span><span class="hl-5">0.87</span><span class="hl-1">, </span><span class="hl-4">&quot;path&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;d:/meetings/2026-02-15/notes.md&quot;</span><span class="hl-1">, </span><span class="hl-4">&quot;title&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Billing Discussion&quot;</span><span class="hl-1"> }</span><br/><span class="hl-1">...</span>
</code><button type="button">Copy</button></pre>

<h3 id="enrich-multiple-files" class="tsd-anchor-link">Enrich Multiple Files<a href="#enrich-multiple-files" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-10">for</span><span class="hl-1"> </span><span class="hl-8">file</span><span class="hl-1"> </span><span class="hl-10">in</span><span class="hl-1"> </span><span class="hl-2">file1.md</span><span class="hl-1"> </span><span class="hl-2">file2.md</span><span class="hl-1"> </span><span class="hl-2">file3.md</span><span class="hl-1">; </span><span class="hl-10">do</span><br/><span class="hl-1">  </span><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-3">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/metadata</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">    </span><span class="hl-3">-H</span><span class="hl-1"> </span><span class="hl-2">&quot;Content-Type: application/json&quot;</span><span class="hl-1"> </span><span class="hl-6">\</span><br/><span class="hl-1">    </span><span class="hl-3">-d</span><span class="hl-1"> </span><span class="hl-2">&quot;{</span><span class="hl-6">\&quot;</span><span class="hl-2">path</span><span class="hl-6">\&quot;</span><span class="hl-2">: </span><span class="hl-6">\&quot;</span><span class="hl-8">$file</span><span class="hl-6">\&quot;</span><span class="hl-2">, </span><span class="hl-6">\&quot;</span><span class="hl-2">metadata</span><span class="hl-6">\&quot;</span><span class="hl-2">: {</span><span class="hl-6">\&quot;</span><span class="hl-2">reviewed</span><span class="hl-6">\&quot;</span><span class="hl-2">: true}}&quot;</span><br/><span class="hl-10">done</span>
</code><button type="button">Copy</button></pre>

<h3 id="check-service-health" class="tsd-anchor-link">Check Service Health<a href="#check-service-health" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3>
<pre><code class="bash"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-2">http://localhost:3100/status</span><span class="hl-1"> | </span><span class="hl-0">jq</span><span class="hl-1"> </span><span class="hl-2">&#39;.uptime&#39;</span>
</code><button type="button">Copy</button></pre>

<p>Output: <code>86400</code> (uptime in seconds)</p>
<hr>
<h2 id="next-steps" class="tsd-anchor-link">Next Steps<a href="#next-steps" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2>
<ul>
<li><a href="CLI_Reference.html">CLI Reference</a> — CLI equivalents for these endpoints</li>
<li><a href="Configuration_Reference.html">Configuration Reference</a> — API server settings</li>
<li><a href="Architecture.html">Architecture Guide</a> — How the API fits into the system</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#api-reference"><span>API <wbr/>Reference</span></a><ul><li><a href="#get-status"><span>GET /status</span></a></li><li><ul><li><a href="#request"><span>Request</span></a></li><li><a href="#response"><span>Response</span></a></li></ul></li><li><a href="#post-metadata"><span>POST /metadata</span></a></li><li><ul><li><a href="#request-1"><span>Request</span></a></li><li><a href="#response-1"><span>Response</span></a></li><li><a href="#behavior"><span>Behavior</span></a></li></ul></li><li><a href="#post-search"><span>POST /search</span></a></li><li><ul><li><a href="#request-2"><span>Request</span></a></li><li><a href="#response-2"><span>Response</span></a></li><li><a href="#response-schema"><span>Response <wbr/>Schema</span></a></li><li><a href="#behavior-1"><span>Behavior</span></a></li></ul></li><li><a href="#post-reindex"><span>POST /reindex</span></a></li><li><ul><li><a href="#request-3"><span>Request</span></a></li><li><a href="#response-3"><span>Response</span></a></li><li><a href="#behavior-2"><span>Behavior</span></a></li></ul></li><li><a href="#post-rebuild-metadata"><span>POST /rebuild-<wbr/>metadata</span></a></li><li><ul><li><a href="#request-4"><span>Request</span></a></li><li><a href="#response-4"><span>Response</span></a></li><li><a href="#behavior-3"><span>Behavior</span></a></li></ul></li><li><a href="#post-config-reindex"><span>POST /config-<wbr/>reindex</span></a></li><li><ul><li><a href="#request-5"><span>Request</span></a></li><li><a href="#response-5"><span>Response</span></a></li><li><a href="#behavior-4"><span>Behavior</span></a></li><li><ul><li><a href="#scope"><span>Scope: </span></a></li><li><a href="#scope-1"><span>Scope: </span></a></li></ul></li></ul></li><li><a href="#error-handling"><span>Error <wbr/>Handling</span></a></li><li><a href="#authentication"><span>Authentication</span></a></li><li><a href="#rate-limiting"><span>Rate <wbr/>Limiting</span></a></li><li><a href="#cors"><span>CORS</span></a></li><li><a href="#examples"><span>Examples</span></a></li><li><ul><li><a href="#search-and-display-results"><span>Search and <wbr/>Display <wbr/>Results</span></a></li><li><a href="#enrich-multiple-files"><span>Enrich <wbr/>Multiple <wbr/>Files</span></a></li><li><a href="#check-service-health"><span>Check <wbr/>Service <wbr/>Health</span></a></li></ul></li><li><a href="#next-steps"><span>Next <wbr/>Steps</span></a></li></ul></div></details></div><div class="site-menu"><nav id="tsd-sidebar-links" class="tsd-navigation"><a href="https://github.com/karmaniverous/jeeves-watcher" class="tsd-nav-link">GitHub</a></nav><nav class="tsd-navigation"><a href="../modules.html">@karmaniverous/jeeves-watcher</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
